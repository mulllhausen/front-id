<?php

if (!defined("processing_dir")) define("processing_dir", $argv[1]);
include_once(processing_dir."/functions.php");
include_once(processing_dir."/css/globals.php");

// todo:
// - login (by loading encrypted private key and entering password)
// - login (by generating new encrypted private key and password)
// - logout
// - save encrypted private key
// - show/update linked sites and their permissions
// - link to security analysis
// - link to developer material (API usage)
?>
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <title>frontID</title>

        <link rel="stylesheet" href="<? echo qs_link("/css/main.css"); ?>"/>

<?/* link rel="preload" as="image" href="<? echo qs_link("/images/icons.svg"); ?>" */?>
        <link rel="preload" as="script" href="<? echo qs_link("/js/main.js"); ?>"/>

        <meta name="viewport" content="width=device-width, height=device-height initial-scale=1.0, user-scalable=no"/>
        <meta name="description" content="<? echo site_description; ?>"/>
        <meta name="author" content="<? echo author; ?>"/>

        <meta name="theme-color" content="<? echo css_background_color1; ?>"/>
        <meta name="apple-mobile-web-app-capable" content="yes"/>
        <meta name="apple-mobile-web-app-status-bar-style" content="<? echo css_background_color1_name; ?>"/>
        <meta name="msapplication-navbutton-color" content="<? echo css_background_color1; ?>"/>

        <link rel="shortcut icon" href="<? echo qs_link("/images/favicon.ico"); ?>" type="image/x-icon"/>
        <link rel="icon" href="<? echo qs_link("/images/favicon.ico"); ?>" type="image/x-icon"/>
        <link rel="apple-touch-icon" href="<? echo qs_link("/images/apple-touch-icon.png"); ?>" />
        <link rel="apple-touch-icon" sizes="72x72" href="<? echo qs_link("/images/apple-touch-icon-72x72.png"); ?>" />
        <link rel="apple-touch-icon" sizes="114x114" href="<? echo qs_link("/images/apple-touch-icon-114x114.png"); ?>" />
        <!--[if IE]><script>isIE9OrLess = true;</script><![endif]-->
        <script src="<? echo qs_link("/js/main.js"); ?>"></script>
        <script type="application/ld+json"><? echo ld_json(__FILE__, "dashboard"); ?></script>

        <script>
var siteGlobals = {};
        </script>

        <link rel="manifest" href="<? echo qs_link("/js/manifest.json"); ?>" />
    </head>
    <body>
        <div id="fullpagePopupNotification" class="popup-fullpage" style="display:none;">
            <span class="popup-centerer">
                <h1><span id="fullpagePopupHeading"></span></h1><br>
                <span id="fullpagePopupDetail"></span>
            </span>
        </div>
        <script>
            if (window.hasOwnProperty == null) {
                document.getElementById('fullpagePopupHeading').innerHTML = 'your browser is too old';
                document.getElementById('fullpagePopupDetail').innerHTML = 'sorry, this website cannot run on your browser';
                document.getElementById('fullpagePopupNotification').style.display = 'table';
                nonExistentFunctionThatHaltsJavascript();
            }
        </script>
<?/*
    .container has all the content in it. on pc it is a vertical strip down the
    middle. on phone and tablet it is the full page width.
*/?>
        <div class="popup-store">
<? include_once(processing_dir."/popup_profile_pic.html"); ?>
        </div>
        <div class="page">
            <div class="header">
<?
$textlogo = '</span><span class="textlogo">frontID</span><span>';
for($i = 0; $i < layout_header_num_lines; $i++)
{
?>
                <div class="centertext">
                    <span>
<? echo random_b64(1000, ($i == 1) ? $textlogo : ""); ?>
                    </span>
                </div>
<? } ?>
            </div>
            <div class="logo-container">
                <img id="hexagonLogo" src="<? echo qs_link("/images/hexagon.svg"); ?>">
                <div id="logoClicker" class="logo-clicker"></div>
            </div>
        </div>
    </body>
</html>
